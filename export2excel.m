% Export Data to Excel 
% Note: please change the rows you want to export (e.g., 1:108,325:432,649:756)!!!! 
% first array
i = 1;
Subjinfo = SubjStats(i).demographics.values{2};
Task = SubjStats(i).demographics.values{1};
TableforCSV = horzcat(array2table(repmat({Subjinfo},108*3,1),'VariableNames',{'Subjinfo'}),...
    array2table(repmat({Task},108*3,1),'VariableNames',{'Task'}),...
    SubjStats(i).variables([1:108,325:432,649:756],:),...
    array2table(SubjStats(i).beta([1:108,325:432,649:756]),'VariableNames',{'Beta'}),...
    array2table(SubjStats(i).tstat([1:108,325:432,649:756]),'VariableNames',{'tstat'}),...
    array2table(SubjStats(i).p([1:108,325:432,649:756]),'VariableNames',{'p'}),...
    array2table(SubjStats(i).q([1:108,325:432,649:756]),'VariableNames',{'q'}));
% all the remaining array
for i = 2:length(SubjStats)
    disp(i)
    Subjinfo = SubjStats(i).demographics.values{2};
    Task = SubjStats(i).demographics.values{1};
    tmp = horzcat(array2table(repmat({Subjinfo},108*3,1),'VariableNames',{'Subjinfo'}),...
        array2table(repmat({Task},108*3,1),'VariableNames',{'Task'}),...
        SubjStats(i).variables([1:108,325:432,649:756],:),...
        array2table(SubjStats(i).beta([1:108,325:432,649:756]),'VariableNames',{'Beta'}),...
        array2table(SubjStats(i).tstat([1:108,325:432,649:756]),'VariableNames',{'tstat'}),...
        array2table(SubjStats(i).p([1:108,325:432,649:756]),'VariableNames',{'p'}),...
        array2table(SubjStats(i).q([1:108,325:432,649:756]),'VariableNames',{'q'}));
    TableforCSV = vertcat(TableforCSV,tmp);
end
% write table to execl
writetable(TableforCSV,'Table.csv')
